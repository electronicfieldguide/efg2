<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
	<head>
	  <title>Upload an EFG Zip File</title>
	  <link href="../css/upload.css" rel="stylesheet" type="text/css" />
	  <script src="../js/trimfunctions.js" language="JavaScript"  type="text/javascript"></script>						  
	  <script src="../js/prototype.js" language="JavaScript" type="text/javascript"></script>
	  <script src="../js/uploads.js" language="JavaScript" type="text/javascript"></script>
	  <script type="text/javascript" language="JavaScript">
		  <!--
		  var updater = null;
		
		  function validateForm(){
		  	var fileToUpload = document.getElementById('importFile');
			return validateFormFieldsForFileType(fileToUpload);		
		  }
		  function startStatusCheck()
		  {
			
			if(!validateForm()){
				return false;
			}
			else{
			    $('submitButton').disabled = true;
			
			    updater = new Ajax.PeriodicalUpdater(
			                                'status',
			                                'importEFG',
			                                {asynchronous:true, frequency:1, method: 'get', parameters: 'c=status', onFailure: reportAjaxError});
			
			    return true;
		    }
		  }
		  function killUpdate(message)
		  {
		    $('submitButton').disabled = false;
		
		    updater.stop();
		    if(message != '')
		    {
		      $('status').innerHTML = '<div class="error"><b>Error processing results: ' + message + '</b></div>';
		    }
		    else
		    {
		      new Ajax.Updater('status',
		                     'importEFG',
		                     {asynchronous:true, method: 'get', parameters: 'c=status', onFailure: reportAjaxError});
		    }
		  }	  
		  	//-->
		</script> 
	</head>
	<body>
	
	  <!-- This iframe is used as a place for the post to load -->
	  <iframe id='target_upload' name='target_upload' src='' style='display: none'></iframe>
	  <form enctype="multipart/form-data" name="form" method="post" action="importEFG" onsubmit="return startStatusCheck();" target="target_upload">
	   EFG2 Zip File: <input id="importFile" name="importFile" type="file" size="100"> <br/>
		<br/>
	    <input id="submitButton" type="submit" value="Import Data"/>
	   
	  </form>
	
	  <!-- This is the upload status area -->
	  <div id="status"></div>
	
	</body>
</html>
